(this["webpackJsonp03-react-router-formik"]=this["webpackJsonp03-react-router-formik"]||[]).push([[0],{10:function(e){e.exports=JSON.parse('[{"id":1,"username":"yaroslav","role":"admin","timestamp":1627934490151},{"id":2,"username":"test-user","role":"user","timestamp":1627934784096}]')},46:function(e,t,r){},47:function(e,t,r){},48:function(e,t,r){},49:function(e,t,r){"use strict";r.r(t);var n,c,s=r(0),a=r(32),i=r.n(a),u=r(2),o=r(18),j="view",b="create",d="edit",l=r(11),O=r(16),f=r(5),x=r.n(f),h=r(13),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:800;return new Promise((function(t){setTimeout(t,e)}))},m=function(){return Date.now()},v=function(e){throw new Error("Record with ID ".concat(e," does not exist"))},w=r(10),g=(n=w.length,function(){return++n}),k={getUsers:function(){return Object(h.a)(x.a.mark((function e(){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(1e3);case 2:return console.log("GET /users",w),e.abrupt("return",w);case 4:case"end":return e.stop()}}),e)})))()},getUser:function(e){return Object(h.a)(x.a.mark((function t(){var r;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p();case 2:if(!(r=w.find((function(t){return t.id===e})))){t.next=8;break}return console.log("GET /users/".concat(r.id),r),t.abrupt("return",r);case 8:v(e);case 9:case"end":return t.stop()}}),t)})))()},createUser:function(e){return Object(h.a)(x.a.mark((function t(){var r;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p();case 2:return r=Object(O.a)(Object(O.a)({},e),{},{id:g(),timestamp:m()}),w.push(r),console.log("POST /users",r),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})))()},editUser:function(e){return Object(h.a)(x.a.mark((function t(){var r;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p();case 2:if(!~(r=w.findIndex((function(t){return t.id===e.id})))){t.next=9;break}return w[r]=Object(O.a)(Object(O.a)({},e),{},{timestamp:m()}),console.log("PUT /users",w[r]),t.abrupt("return",w[r]);case 9:v(e.id);case 10:case"end":return t.stop()}}),t)})))()},deleteUser:function(e){return Object(h.a)(x.a.mark((function t(){var r;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p();case 2:if(!~(r=w.findIndex((function(t){return t===e.id})))){t.next=8;break}return console.log("DELETE /users",e),t.abrupt("return",w.splice(r,1));case 8:v(e.id);case 9:case"end":return t.stop()}}),t)})))()},getRoles:function(){return Object(h.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:return t=["user","super-user","admin"],console.log("GET /roles",t),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})))()}},U=r(21),E="username",S="role",N=(c={},Object(U.a)(c,E,""),Object(U.a)(c,S,""),c),y=r(1);var T=function(e){var t=e.id,r=Object(u.i)().url,n=Object(u.g)(),c=function(e){return function(){n.push("".concat(r,"/user/").concat(e,"/").concat(t))}};return Object(y.jsxs)("div",{className:"Actions",children:[Object(y.jsx)("button",{onClick:c(j),children:"View"})," ",Object(y.jsx)("button",{onClick:c(d),children:"Edit"})]})};r(46);var A=function(e){var t=e.users,r=e.setUsers,n=Object(u.i)().url;return Object(s.useEffect)((function(){k.getUsers().then(r)}),[r]),Object(y.jsxs)("div",{className:"UsersTable",children:[Object(y.jsx)(l.b,{to:"".concat(n,"/user/").concat(b),children:"Create User"}),Object(y.jsxs)("table",{children:[Object(y.jsx)("thead",{children:Object(y.jsxs)("tr",{children:[Object(y.jsx)("th",{children:"ID"}),Object(y.jsx)("th",{children:"Username"}),Object(y.jsx)("th",{children:"Role"}),Object(y.jsx)("th",{children:"Last Updated At"}),Object(y.jsx)("th",{children:"Actions"})]})}),Object(y.jsx)("tbody",{children:t.map((function(e){return Object(y.jsxs)("tr",{children:[Object(y.jsx)("td",{children:e.id}),Object(y.jsx)("td",{children:e.username}),Object(y.jsx)("td",{children:e.role}),Object(y.jsx)("td",{children:e.timestamp}),Object(y.jsx)("td",{children:Object(y.jsx)(T,{id:e.id})})]},e.id)}))})]})]})},I=r(35),C=r(15);r(47);var R=function(e){var t=e.name,r=e.label,n=e.validate,c=e.type,s=void 0===c?"text":c,a=e.disabled,i=void 0!==a&&a,u=Object(C.d)({name:t,validate:n}),j=Object(o.a)(u,1)[0];return Object(y.jsxs)("div",{className:"Input",children:[Object(y.jsxs)("label",{children:[Object(y.jsx)("div",{children:r}),Object(y.jsx)("input",Object(O.a)({type:s,disabled:i},j))]}),Object(y.jsx)(C.a,{name:t,className:"error",component:"div"})]})};var D=function(e){var t=e.mode,r=Object(u.g)(),n=Object(C.e)().isSubmitting;return Object(y.jsxs)("div",{children:[(t===b||t===d)&&Object(y.jsx)("button",{type:"submit",disabled:n,children:"Save"}),Object(y.jsx)("button",{type:"button",onClick:function(){return r.push("/users")},children:"Cancel"})]})};var V=function(e){var t=e.initialValues,r=e.onSubmit,n=e.mode,c=e.roles;return Object(y.jsx)(C.c,{initialValues:t,onSubmit:r,children:Object(y.jsxs)(C.b,{children:[Object(y.jsx)(R,{name:E,label:"Username",disabled:n===j}),Object(y.jsx)(R,{name:S,label:"Role",disabled:n===j,validate:function(e){if(!c.includes(e))return"Allowed roles: ".concat(c.join(", "))}}),Object(y.jsx)("br",{}),Object(y.jsx)(D,{mode:n})]})})};var G=function(e){var t=e.users,r=e.setUsers,n=Object(u.h)(),c=n.mode,a=n.id,i=Object(u.g)(),l=t.find((function(e){return e.id===Number(a)}));Object(s.useEffect)((function(){c!==j&&c!==d||l||k.getUser(Number(a)).then((function(e){return r((function(t){return[].concat(Object(I.a)(t),[e])}))})).catch((function(e){return window.alert(e.message)}))}),[a,c,l,r]);var O=Object(s.useState)([]),f=Object(o.a)(O,2),p=f[0],m=f[1];Object(s.useEffect)((function(){k.getRoles().then(m)}),[r]);var v=function(){var e=Object(h.a)(x.a.mark((function e(t){var r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=t,e.t0=c,e.next=e.t0===b?5:e.t0===d?8:11;break;case 5:return e.next=7,k.createUser(r);case 7:return e.abrupt("break",12);case 8:return e.next=10,k.editUser(r);case 10:return e.abrupt("break",12);case 11:console.error("Failed to execute this request for ".concat(c," mode"));case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(0),window.alert(e.t1.message);case 17:i.push("/users");case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),w=function(e){return e||N}(l);return Object(y.jsx)(V,{initialValues:w,onSubmit:v,mode:c,roles:p},"".concat(c,":").concat(w.id))};var J=function(){var e=Object(u.i)().path,t=Object(s.useState)([]),r=Object(o.a)(t,2),n=r[0],c=r[1];return Object(y.jsx)("div",{className:"App",children:Object(y.jsxs)(u.d,{children:[Object(y.jsx)(u.b,{exact:!0,path:e,children:Object(y.jsx)(A,{users:n,setUsers:c})}),Object(y.jsx)(u.b,{exact:!0,path:"".concat(e,"/user/:mode(").concat(j,"|").concat(b,"|").concat(d,")/:id?"),children:Object(y.jsx)(G,{users:n,setUsers:c})})]})})};var P=function(){return Object(y.jsx)("div",{className:"App",children:Object(y.jsxs)(u.d,{children:[Object(y.jsx)(u.a,{exact:!0,from:"/",to:"/users"}),Object(y.jsx)(u.b,{path:"/users",children:Object(y.jsx)(J,{})})]})})};var L=function(e){var t=e.children;return Object(y.jsx)(l.a,{basename:"/globallogic-js-basecamp-2021/react/03-react-router-formik/build",children:t})},q=(r(48),document.getElementById("root"));i.a.render(Object(y.jsx)(s.StrictMode,{children:Object(y.jsx)(L,{children:Object(y.jsx)(P,{})})}),q)}},[[49,1,2]]]);
//# sourceMappingURL=main.c699f94e.chunk.js.map